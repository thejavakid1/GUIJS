<p></p>
<script>
function loadGUI(guiName){
    //create overlay
    overlay = document.createElement('GUI_overlay');
    overlay.id="overlay";
    document.body.appendChild(overlay)
    //load html
    readFile("guis/"+guiName+".html", OverlayCallback)
    //load script
    var script = document.createElement('script');
    script.src = "guis/"+guiName+".js";
    script.onload = function () {
        try{
            eval(guiName+".init();");
        }catch(e){
            alert("faild to load GUI "+guiName+":\n"+e.message);
        }
    };

    document.head.appendChild(script);
    //detect Escape key
    window.onkeydown = function(e){
        if(e.key == "Escape"){
            if(overlay.style.visibility == "visible"){
                overlay.style.visibility = "hidden";
            }else{
                overlay.style.visibility = "visible";
            }
        }
    };
}
/*
*overlay init functions
*/
function OverlayCallback(layout){
    //set overlay to imported html
    overlay.innerHTML = layout;
}
/*
*filereader code
*/
function readFile(file, callback)
{
    var rawFile = new XMLHttpRequest();
    // put true for serverside stuff
    rawFile.open("GET", file, false);
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4)
        {
            if(rawFile.status === 200 || rawFile.status == 0)
            {
                var style =
                "\n<style>"+
                "#overlay{"+
                "    height: 75%;"+
                "    width: 75%;"+
                "    position:absolute;"+
                "    top: 0;"+
                "    left: 0;"+
                "    bottom: 0;"+
                "    right: 0;"+
                "    margin: auto;"+
                "    background-color: #E0E0E0;"+
                "}"+
                "</style>\n";
                var allText = rawFile.responseText+style;
                callback(allText);
            }
        }
    }
    rawFile.send(null);
}

function GUI (callback){
    this.elements = {};
    this.addButton = function(id, func){
        this.elements[id].onclick = func;
    }
    this.addElement = function(id, trigger,func){
        (this.elements[id])[trigger] = func;
    }
    this.closeWindow = function(){

    }
    this.init = function(){
        for(i =0;i<overlay.children.length; i++){
            this.elements[overlay.children[i].id] = overlay.children[i];
        }
        callback()
    }
    this.hide = function(){
        overlay.style.visibility = "hidden";
    }
}

</script>
